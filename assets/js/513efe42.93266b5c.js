"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[399],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=o.createContext({}),s=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return o.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=s(n),u=a,k=m["".concat(p,".").concat(u)]||m[u]||c[u]||r;return n?o.createElement(k,i(i({ref:t},d),{},{components:n})):o.createElement(k,i({ref:t},d))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6150:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>p,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var o=n(7462),a=n(3366),r=(n(7294),n(3905)),i=["components"],l={id:"connect",title:"\u6559\u7a0b: Connect API",hide_title:!0,sidebar_label:"\u6559\u7a0b\uff1a\u4f7f\u7528 connect API",description:"\u6559\u7a0b > Connect API: how to use the legacy connect API"},p=void 0,s={unversionedId:"tutorials/connect",id:"tutorials/connect",isDocsHomePage:!1,title:"\u6559\u7a0b: Connect API",description:"\u6559\u7a0b > Connect API: how to use the legacy connect API",source:"@site/../docs/tutorials/connect.md",sourceDirName:"tutorials",slug:"/tutorials/connect",permalink:"/tutorials/connect",editUrl:"https://github.com/reduxjs/react-redux/edit/master/website/../docs/tutorials/connect.md",tags:[],version:"current",lastUpdatedAt:1665562402,formattedLastUpdatedAt:"10/12/2022",frontMatter:{id:"connect",title:"\u6559\u7a0b: Connect API",hide_title:!0,sidebar_label:"\u6559\u7a0b\uff1a\u4f7f\u7528 connect API",description:"\u6559\u7a0b > Connect API: how to use the legacy connect API"},sidebar:"docs",previous:{title:"TypeScript \u5feb\u901f\u5165\u95e8",permalink:"/tutorials/typescript-quick-start"},next:{title:"\u4e0e TypeScript \u4e00\u8d77\u4f7f\u7528",permalink:"/using-react-redux/usage-with-typescript"}},d=[{value:"\u4e00\u4e2a Todo List \u793a\u4f8b",id:"\u4e00\u4e2a-todo-list-\u793a\u4f8b",children:[{value:"\u63d0\u4f9b Store",id:"\u63d0\u4f9b-store",children:[],level:3},{value:"\u8fde\u63a5 Components",id:"\u8fde\u63a5-components",children:[],level:3},{value:"\u5e38\u89c1\u7684\u8c03\u7528 <code>connect</code> \u65b9\u5f0f",id:"\u5e38\u89c1\u7684\u8c03\u7528-connect-\u65b9\u5f0f",children:[{value:"\u4e0d\u8ba2\u9605 store \u4e14\u4e0d\u6ce8\u5165 action creators",id:"\u4e0d\u8ba2\u9605-store-\u4e14\u4e0d\u6ce8\u5165-action-creators",children:[],level:4},{value:"\u8ba2\u9605 store \u4e0d\u6ce8\u5165 action creators",id:"\u8ba2\u9605-store-\u4e0d\u6ce8\u5165-action-creators",children:[],level:4},{value:"\u4e0d\u8ba2\u9605 store \u6ce8\u5165 action creators",id:"\u4e0d\u8ba2\u9605-store-\u6ce8\u5165-action-creators",children:[],level:4},{value:"\u8ba2\u9605 store \u6ce8\u5165 action creators",id:"\u8ba2\u9605-store-\u6ce8\u5165-action-creators",children:[],level:4}],level:3}],level:2},{value:"\u94fe\u63a5",id:"\u94fe\u63a5",children:[],level:2},{value:"\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9",id:"\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9",children:[],level:2}],c={toc:d};function m(e){var t=e.components,n=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u6559\u7a0b\u4f7f\u7528-connect-api"},"\u6559\u7a0b\uff1a\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"h1"},"connect")," API"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u5982\u4eca\u6211\u4eec\u4f7f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"/api/hooks"},"React-Redux hooks API \u4f5c\u4e3a\u6211\u4eec\u7684\u9ed8\u8ba4\u63a8\u8350"),"\u3002\u4f46\u662f\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," API \u4ecd\u7136\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002"),(0,r.kt)("p",{parentName:"div"},"\u672c\u6559\u7a0b\u8fd8\u5c55\u793a\u4e86\u4e00\u4e9b\u6211\u4eec\u4e0d\u518d\u63a8\u8350\u7684\u65e7\u505a\u6cd5\uff0c\u4f8b\u5982\u6309\u7c7b\u578b\u5c06 Redux \u903b\u8f91\u5206\u6210\u6587\u4ef6\u5939\u7684\u505a\u6cd5\u3002\u4e3a\u4e86\u5b8c\u6574\u8d77\u89c1\uff0c\u6211\u4eec\u5c06\u672c\u6559\u7a0b\u4fdd\u6301\u539f\u6837\uff0c\u4f46\u5efa\u8bae\u901a\u8fc7 Redux \u6587\u6863\u4e2d\u7684 ",(0,r.kt)("a",{parentName:"p",href:"https://redux.js.org/tutorials/essentials/part-1-overview-concepts"},"Redux Essentials \u6559\u7a0b"),"\u548c ",(0,r.kt)("a",{parentName:"p",href:"https://redux.js.org/style-guide/style-guide"},"Redux \u6837\u5f0f\u6307\u5357"),"\uff0c\u4e86\u89e3\u6211\u4eec\u5f53\u524d\u7684\u6700\u4f73\u5b9e\u8df5\u3002"),(0,r.kt)("p",{parentName:"div"},"\u6211\u4eec\u6b63\u5728\u7f16\u5199\u4e00\u4e2a\u4ecb\u7ecd hooks API \u7684\u65b0\u6559\u7a0b\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eec\u5efa\u8bae\u9605\u8bfb ",(0,r.kt)("a",{parentName:"p",href:"https://redux.js.org/tutorials/fundamentals/part-5-ui-react"},(0,r.kt)("strong",{parentName:"a"},"Redux Fundamentals, Part 5: UI and React"))," \u4ee5\u83b7\u5f97 hooks \u6559\u7a0b\u3002"))),(0,r.kt)("p",null,"\u6211\u4eec\u5c06\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a todo list \u5e94\u7528\u6765\u4e00\u6b65\u6b65\u5c55\u793a\u5982\u4f55\u5728\u5b9e\u8df5\u4e2d\u4f7f\u7528 React Redux\u3002"),(0,r.kt)("h2",{id:"\u4e00\u4e2a-todo-list-\u793a\u4f8b"},"\u4e00\u4e2a Todo List \u793a\u4f8b"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u8df3\u5230")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\ud83e\udd1e ",(0,r.kt)("a",{parentName:"li",href:"https://codesandbox.io/s/9on71rvnyo"},"\u7ed9\u6211\u770b\u4e00\u4e0b\u4ee3\u7801")),(0,r.kt)("li",{parentName:"ul"},"\ud83d\udc46 ",(0,r.kt)("a",{parentName:"li",href:"#providing-the-store"},"\u63d0\u4f9b store")),(0,r.kt)("li",{parentName:"ul"},"\u270c\ufe0f ",(0,r.kt)("a",{parentName:"li",href:"#connecting-the-components"},"\u8fde\u63a5 Component"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"React UI \u7ec4\u4ef6")),(0,r.kt)("p",null,"\u6211\u4eec\u5df2\u7ecf\u5b9e\u73b0\u7684 React UI \u7ec4\u4ef6\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"TodoApp")," \u662f\u6211\u4eec\u5e94\u7528\u7684\u5165\u53e3\u3002\u5b83\u6e32\u67d3 header\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"AddTodo"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"TodoList")," \u548c ",(0,r.kt)("inlineCode",{parentName:"li"},"VisibilityFilters")," \u7ec4\u4ef6\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"AddTodo")," \u662f\u4e00\u4e2a\u5141\u8bb8\u7528\u6237\u8f93\u5165\u4ee3\u529e\u4e8b\u9879\u5e76\u901a\u8fc7\u70b9\u51fb Add Todo \u6309\u94ae\u6dfb\u52a0\u5230\u5217\u8868\u4e2d\u7684\u7ec4\u4ef6\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5b83\u901a\u8fc7 input \u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"onChange")," \u4e8b\u4ef6\u53bb\u8bbe\u7f6e state\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5f53\u7528\u6237\u70b9\u51fb Add Todo \u6309\u94ae\u65f6\uff0c\u5b83\u901a\u8fc7 dispatches action\uff08\u6211\u4eec\u5c06\u4f7f\u7528 React Redux \u7684\u63d0\u4f9b\uff09\u628a todo \u52a0\u5230 store \u4e2d"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"TodoList")," \u662f\u4e00\u4e2a\u6e32\u67d3 todos \u5217\u8868\u7684\u7ec4\u4ef6\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5f53\u5176\u4e2d\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"VisibilityFilters")," \u88ab\u9009\u4e2d\u65f6\uff0c\u5b83\u4f1a\u6e32\u67d3\u88ab\u8fc7\u6ee4\u7684 todos \u5217\u8868\u3002"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Todo")," \u662f\u4e00\u4e2a\u6e32\u67d3\u5355\u4e2a todo \u7684\u7ec4\u4ef6\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5b83\u6e32\u67d3 todo \u7684\u5185\u5bb9\uff0c\u5e76\u663e\u793a\u4e00\u4e2a todo \u662f\u901a\u8fc7\u5212\u6389\u5b83\u6765\u663e\u793a\u5df2\u5b8c\u6210\u7684\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5b83\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"onClick")," \u53bb dispatches action \u5207\u6362 todo \u7684\u5b8c\u6210\u72b6\u6001\u3002"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"VisibilityFilters")," \u6e32\u67d3\u4e00\u7ec4\u7b80\u5355\u7684\u8fc7\u6ee4\u5668\uff1a ",(0,r.kt)("em",{parentName:"li"},"all"),"\uff0c",(0,r.kt)("em",{parentName:"li"},"completed")," \u548c ",(0,r.kt)("em",{parentName:"li"},"incomplete"),"\u3002\u5355\u51fb\u6bcf\u4e00\u4e2a\u8fc7\u6ee4 todos\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5b83\u63a5\u53d7\u6765\u81ea\u7236\u7ea7\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"activeFilter")," \u5c5e\u6027\uff0c\u6307\u793a\u7528\u6237\u5f53\u524d\u9009\u62e9\u4e86\u54ea\u4e2a\u8fc7\u6ee4\u5668\u3002\u4e00\u4e2a\u88ab\u6fc0\u6d3b\u7684\u8fc7\u6ee4\u5668\u4f1a\u5728\u6e32\u67d3\u65f6\u5305\u542b\u4e0b\u5212\u7ebf\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5b83 dispatches ",(0,r.kt)("inlineCode",{parentName:"li"},"setFilter")," action \u53bb\u66f4\u65b0\u88ab\u9009\u4e2d\u7684\u8fc7\u6ee4\u5668\u3002"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"constants")," \u4fdd\u5b58\u6211\u4eec\u5e94\u7528\u7684\u5e38\u91cf\u6570\u636e\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u6700\u540e ",(0,r.kt)("inlineCode",{parentName:"li"},"index")," \u5c06\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u6e32\u67d3\u5230 DOM\u3002")),(0,r.kt)("br",null),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Redux Store")),(0,r.kt)("p",null,"\u5e94\u7528\u7a0b\u5e8f\u7684 Redux \u90e8\u5206\u5df2\u4f7f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"https://redux.js.org"},"Redux \u6587\u6863\u4e2d\u63a8\u8350\u7684\u6a21\u5f0f"),"\u8fdb\u884c\u8bbe\u7f6e\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Store",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"todos"),"\uff1a\u4e00\u4e2a\u5f52\u4e00\u5316\u7684 todos \u7684 reducer\u3002\u5b83\u5305\u542b\u4e00\u4e2a\u5bf9\u4e8e\u6240\u6709 todo \u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"byIds")," map \u548c\u4e00\u4e2a\u5305\u542b\u6240\u6709 id \u5217\u8868\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"allIds"),"\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"visibilityFilters"),"\uff1a\u4e00\u4e2a\u7b80\u5355\u7684\u5b57\u7b26\u4e32 ",(0,r.kt)("inlineCode",{parentName:"li"},"all"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"completed")," \u6216\u8005 ",(0,r.kt)("inlineCode",{parentName:"li"},"incomplete"),"\u3002"))),(0,r.kt)("li",{parentName:"ul"},"Action Creators",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"addTodo")," \u521b\u5efa action \u6dfb\u52a0\u5230 todos \u4e2d\u3002\u5b83\u91c7\u7528\u5355\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf ",(0,r.kt)("inlineCode",{parentName:"li"},"content")," \u5e76\u8fd4\u56de\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"ADD_TODO")," action \u5e76\u4e14 ",(0,r.kt)("inlineCode",{parentName:"li"},"payload")," \u5305\u542b\u81ea\u589e\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," \u548c ",(0,r.kt)("inlineCode",{parentName:"li"},"content")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"toggleTodo")," \u521b\u5efa action \u53bb\u5207\u6362 todos\u3002\u5b83\u91c7\u7528\u5355\u4e2a\u6570\u5b57\u53d8\u91cf ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," \u5e76\u8fd4\u56de\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"TOGGLE_TODO")," action \u5e76\u4e14 ",(0,r.kt)("inlineCode",{parentName:"li"},"payload")," \u53ea\u5305\u542b ",(0,r.kt)("inlineCode",{parentName:"li"},"id")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"setFilter")," \u521b\u5efa action \u53bb\u8bbe\u7f6e app \u7684\u6fc0\u6d3b\u8fc7\u6ee4\u5668\u3002\u5b83\u91c7\u7528\u5355\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf ",(0,r.kt)("inlineCode",{parentName:"li"},"filter")," \u5e76\u8fd4\u56de\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"SET_FILTER")," action \u5e76\u4e14 ",(0,r.kt)("inlineCode",{parentName:"li"},"payload")," \u5305\u542b ",(0,r.kt)("inlineCode",{parentName:"li"},"filter")," \u81ea\u8eab\u3002"))),(0,r.kt)("li",{parentName:"ul"},"Reducers",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"todos")," reducer",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6dfb\u52a0 ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," \u5230\u81ea\u8eab\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"allIds")," \u5b57\u6bb5\u4e2d\u5e76\u5728\u6536\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"ADD_TODO")," action \u540e\u5728\u5176 ",(0,r.kt)("inlineCode",{parentName:"li"},"byIds")," \u5b57\u6bb5\u4e2d\u8bbe\u7f6e todo"),(0,r.kt)("li",{parentName:"ul"},"\u5728\u6536\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"TOGGLE_TODO")," action \u540e\u5207\u6362 todo \u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"completed")," \u5b57\u6bb5"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"visibilityFilters")," reducer \u8bbe\u7f6e slice store \u4e3a\u4ece ",(0,r.kt)("inlineCode",{parentName:"li"},"SET_FILTER")," action payload \u4e2d\u7684\u65b0 filter"))),(0,r.kt)("li",{parentName:"ul"},"Action Types",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"actionTypes.js")," \u6587\u4ef6\u53bb\u4fdd\u5b58\u90a3\u4e9b\u91cd\u590d\u4f7f\u7528\u7684 action types \u5e38\u91cf"))),(0,r.kt)("li",{parentName:"ul"},"Selectors",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getTodoList")," \u4ece ",(0,r.kt)("inlineCode",{parentName:"li"},"todos")," store \u4e2d\u8fd4\u56de ",(0,r.kt)("inlineCode",{parentName:"li"},"allIds")," \u5217\u8868"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getTodoById")," \u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," \u67e5\u5230 todo"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getTodos")," \u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\u3002\u5b83\u4ece ",(0,r.kt)("inlineCode",{parentName:"li"},"allIds")," \u4e2d\u83b7\u53d6\u6240\u6709\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"id"),"\uff0c\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"byIds")," \u4e2d\u627e\u5230\u6bcf\u4e2a todo\uff0c\u5e76\u5728\u6700\u540e\u8fd4\u56de\u4e00\u4e2a todos \u7684\u6570\u7ec4"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getTodosByVisibilityFilter")," \u6839\u636e visibility filter \u8fc7\u6ee4 todos")))),(0,r.kt)("p",null,"\u4f60\u53ef\u4ee5\u901a\u8fc7\u67e5\u9605",(0,r.kt)("a",{parentName:"p",href:"https://codesandbox.io/s/6vwyqrpqk3"},"\u6b64 CodeSandbox")," \u83b7\u53d6 UI components \u7684\u6e90\u7801\u548c\u4e0a\u8ff0\u672a\u8fde\u63a5\u7684 Redux store"),(0,r.kt)("br",null),(0,r.kt)("p",null,"\u73b0\u5728\u6211\u4eec\u5c06\u5c55\u793a\u5982\u4f55\u4f7f\u7528 React Redux \u5c06 store \u8fde\u63a5\u5230\u6211\u4eec\u7684\u5e94\u7528\u4e2d\u3002"),(0,r.kt)("h3",{id:"\u63d0\u4f9b-store"},"\u63d0\u4f9b Store"),(0,r.kt)("p",null,"\u7b2c\u4e00\u6b65\u6211\u4eec\u9700\u8981\u4f7f\u5f97 ",(0,r.kt)("inlineCode",{parentName:"p"},"store")," \u5bf9\u4e8e\u6211\u4eec\u7684\u5e94\u7528\u662f\u53ef\u89c1\u7684\u3002\u4e3a\u4e86\u505a\u5230\u8fd9\u4e2a\uff0c\u6211\u4eec\u4f7f\u7528 React Redux \u63d0\u4f9b\u7684 API ",(0,r.kt)("inlineCode",{parentName:"p"},"<Provider />")," \u53bb\u5305\u88f9\u6211\u4eec\u7684\u5e94\u7528\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"// index.js\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport TodoApp from './TodoApp';\n\nimport { Provider } from 'react-redux';\nimport store from './redux/store';\n\n// React 18 \u4ee5\u540e\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <Provider store={store}>\n    <TodoApp />\n  </Provider>\n);\n")),(0,r.kt)("p",null,"\u6ce8\u610f\u6211\u4eec\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"<TodoApp />")," \u73b0\u5728\u662f\u5982\u4f55\u88ab ",(0,r.kt)("inlineCode",{parentName:"p"},"<Provider />")," \u5305\u88f9\u7684\uff0c\u5176\u4e2d ",(0,r.kt)("inlineCode",{parentName:"p"},"store")," \u4f5c\u4e3a prop \u4f20\u5165\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/LV0XvwA.png",alt:null})),(0,r.kt)("h3",{id:"\u8fde\u63a5-components"},"\u8fde\u63a5 Components"),(0,r.kt)("p",null,"React Redux \u63d0\u4f9b\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u51fd\u6570\u4f7f\u4f60\u53ef\u4ee5\u8bfb\u53d6 Redux store\uff08\u5e76\u4e14\u5f53 store \u66f4\u65b0\u65f6\u4f1a\u518d\u6b21\u53bb\u8bfb\u53d6\u503c\uff09\u7684\u503c\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u51fd\u6570\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff0c\u90fd\u662f\u53ef\u9009\u7684\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps"),"\uff1a\u5728\u6bcf\u4e00\u6b21 store state \u6539\u53d8\u65f6\u88ab\u8c03\u7528\u3002\u5b83\u63a5\u6536\u6574\u4e2a store state\uff0c\u5e76\u8fd4\u56de\u8be5\u7ec4\u4ef6\u9700\u8981\u7684\u6570\u636e\u5bf9\u8c61\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"mapDispatchToProps"),": \u6b64\u53c2\u6570\u53ef\u4ee5\u662f\u4e00\u4e2a function\uff0c\u6216\u8005\u4e00\u4e2a object\u3002"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u5b83\u662f function\uff0c\u4f1a\u5728 component \u521b\u5efa\u65f6\u7acb\u9a6c\u88ab\u8c03\u7528\u3002\u5b83\u5c06\u63a5\u6536 ",(0,r.kt)("inlineCode",{parentName:"li"},"dispatch")," \u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\uff0c\u5e76\u4e14\u5e94\u8be5\u8fd4\u56de\u4e00\u4e2a object\uff0c\u5176\u4e2d\u5305\u542b\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"dispatch")," \u6765 dispatch actions \u7684\u51fd\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u5145\u6ee1 action creators \u7684 object\uff0c\u6bcf\u4e2a action creator \u90fd\u4f1a\u53d8\u6210\u4e00\u4e2a prop \u51fd\u6570\uff0c\u5728\u8c03\u7528\u65f6\u4f1a\u81ea\u52a8 dispatches \u5176 action\u3002",(0,r.kt)("strong",{parentName:"li"},"\u6ce8\u610f"),"\uff1a\u6211\u4eec\u63a8\u8350\u4f7f\u7528\u8fd9\u79cd \u201cobject shorthand\u201d \u5f62\u5f0f\u3002")))),(0,r.kt)("p",null,"\u901a\u5e38\uff0c\u4f60\u4f1a\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect"),"\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const mapStateToProps = (state, ownProps) => ({\n  // ...\u4f9d\u636e state \u548c \u81ea\u5b9a\u4e49 ownProps \u751f\u6210 computed data\n});\n\nconst mapDispatchToProps = {\n  // ... \u901a\u5e38\u662f\u4e00\u4e2a\u5145\u6ee1 action creators \u7684 object\n};\n\n// `connect` \u8fd4\u56de\u4e00\u4e2a\u63a5\u6536\u8981\u5305\u88c5\u7684\u7ec4\u4ef6\u7684\u65b0\u51fd\u6570\uff1a\nconst connectToStore = connect(mapStateToProps, mapDispatchToProps);\n// \u5e76\u4e14\u8be5\u51fd\u6570\u8fd4\u56de\u8fde\u63a5\u7684\uff0c\u5305\u88c5\u7684\u7ec4\u4ef6\uff1a\nconst ConnectedComponent = connectToStore(Component);\n\n// \u901a\u5e38\u6211\u4eec\u4f1a\u5c06\u4e24\u8005\u4e00\u6b65\u5b8c\u6210\uff0c\u50cf\u8fd9\u6837\uff1a\nconnect(mapStateToProps, mapDispatchToProps)(Component);\n")),(0,r.kt)("p",null,"\u8ba9\u6211\u4eec\u5148\u5904\u7406 ",(0,r.kt)("inlineCode",{parentName:"p"},"<AddTodo />"),"\u3002\u5b83\u9700\u8981\u89e6\u53d1\u5bf9 ",(0,r.kt)("inlineCode",{parentName:"p"},"store")," \u7684\u66f4\u6539\u4ee5\u6dfb\u52a0\u65b0\u7684 todos\u3002\u56e0\u6b64\uff0c\u4ed6\u9700\u8981\u80fd\u591f ",(0,r.kt)("inlineCode",{parentName:"p"},"dispatch")," actions \u5230 store\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u662f\u5982\u4f55\u505a\u5230\u7684\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"addTodo")," action creator \u50cf\u8fd9\u6837\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// redux/actions.js\nimport { ADD_TODO } from './actionTypes';\n\nlet nextTodoId = 0;\nexport const addTodo = (content) => ({\n  type: ADD_TODO,\n  payload: {\n    id: ++nextTodoId,\n    content,\n  },\n});\n\n// ... \u5176\u4ed6 actions\n")),(0,r.kt)("p",null,"\u901a\u8fc7\u5c06\u5b83\u4f20\u9012\u7ed9 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect"),"\uff0c\u6211\u4eec\u7684\u7ec4\u4ef6\u5c06\u5176\u4f5c\u4e3a prop \u63a5\u6536\uff0c\u5f53\u5b83\u88ab\u8c03\u7528\u65f6\u5c06\u81ea\u52a8 dispatch action\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// components/AddTodo.js\n\n// ... \u5176\u4ed6\u5bfc\u5165\nimport { connect } from 'react-redux';\nimport { addTodo } from '../redux/actions';\n\nclass AddTodo extends React.Component {\n  // ... \u7ec4\u4ef6\u5b9e\u73b0\n}\n\nexport default connect(null, { addTodo })(AddTodo);\n")),(0,r.kt)("p",null,"\u6ce8\u610f\u73b0\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"<AddTodo />")," \u88ab\u4e00\u4e2a\u53eb\u505a ",(0,r.kt)("inlineCode",{parentName:"p"},"<Connect(AddTodo) />")," \u7684\u7236\u7ec4\u4ef6\u5305\u88f9\u3002\u6b64\u65f6\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"<AddTodo />")," \u73b0\u5728\u83b7\u53d6\u4e00\u4e2a prop\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"addTodo")," action\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/u6aXbwl.png",alt:null})),(0,r.kt)("p",null,"\u6211\u4eec\u8fd8\u9700\u8981\u5b9e\u73b0 ",(0,r.kt)("inlineCode",{parentName:"p"},"handleAddTodo")," \u51fd\u6570\uff0c\u4f7f\u5f97\u5b83 dispatch ",(0,r.kt)("inlineCode",{parentName:"p"},"addTodo")," action \u5e76\u91cd\u7f6e\u8f93\u5165"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"// components/AddTodo.js\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { addTodo } from '../redux/actions';\n\nclass AddTodo extends React.Component {\n  // ...\n\n  handleAddTodo = () => {\n    // dispatches actions \u6dfb\u52a0 todo\n    this.props.addTodo(this.state.input);\n\n    // \u8bbe\u7f6e state \u56de\u5230\u7a7a\u7684\u5b57\u7b26\u4e32\n    this.setState({ input: '' });\n  };\n\n  render() {\n    return (\n      <div>\n        <input\n          onChange={(e) => this.updateInput(e.target.value)}\n          value={this.state.input}\n        />\n        <button className=\"add-todo\" onClick={this.handleAddTodo}>\n          Add Todo\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default connect(null, { addTodo })(AddTodo);\n")),(0,r.kt)("p",null,"\u73b0\u5728\u6211\u4eec\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"<AddTodo />")," \u5df2\u8fde\u63a5\u5230 store\u3002\u5f53\u6211\u4eec\u6dfb\u52a0\u4e00\u4e2a todo\uff0c\u5c06 dispatch action \u53bb\u6539\u53d8 store\u3002\u6211\u4eec\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u770b\u4e0d\u5230\u5b83\u56e0\u4e3a\u5176\u4ed6\u7ec4\u4ef6\u5c1a\u672a\u8fde\u63a5\u3002\u5982\u679c\u4f60\u8fde\u63a5\u4e86 Redux DevTools Extension\uff0c\u4f60\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u6b63\u5728 dispatched action\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/kHvkqhI.png",alt:null})),(0,r.kt)("p",null,"\u4f60\u8fd8\u5e94\u8be5\u770b\u5230 store \u5df2\u76f8\u5e94\u6539\u53d8\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/yx27RVC.png",alt:null})),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"<TodoList />")," \u7ec4\u4ef6\u8d1f\u8d23\u6e32\u67d3 todos \u7684\u5217\u8868\u3002\u56e0\u6b64\uff0c\u5b83\u9700\u8981\u4ece store \u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u6211\u4eec\u901a\u8fc7\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps")," \u53c2\u6570\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u6765\u542f\u7528\u5b83\uff0c\u8be5\u51fd\u6570\u63cf\u8ff0\u4e86\u6211\u4eec\u9700\u8981\u4ece store \u4e2d\u83b7\u53d6\u54ea\u4e00\u90e8\u5206\u6570\u636e\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"<Todo />")," \u7ec4\u4ef6\u5c06 todo item \u4f5c\u4e3a props\u3002\u6211\u4eec\u4ece ",(0,r.kt)("inlineCode",{parentName:"p"},"todos")," \u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"byIds")," \u5b57\u6bb5\u4e2d\u83b7\u5f97\u4e86\u8fd9\u4e9b\u4fe1\u606f\u3002\u4f46\u662f\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u6765\u81ea store \u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"allIds")," \u5b57\u6bb5\u7684\u4fe1\u606f\uff0c\u6307\u793a\u54ea\u4e9b todos \u4ee5\u53ca\u5b83\u4eec\u5e94\u8be5\u4ee5\u4ec0\u4e48\u987a\u5e8f\u5448\u73b0\u3002\u6211\u4eec\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps")," \u53ef\u80fd\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// components/TodoList.js\n\n// ...\u5176\u4ed6\u5bfc\u5165\nimport { connect } from "react-redux";\n\nconst TodoList = // ... UI \u7ec4\u4ef6\u5b9e\u73b0\n\nconst mapStateToProps = state => {\n  const { byIds, allIds } = state.todos || {};\n  const todos =\n    allIds && allIds.length\n      ? allIds.map(id => (byIds ? { ...byIds[id], id } : null))\n      : null;\n  return { todos };\n};\n\nexport default connect(mapStateToProps)(TodoList);\n')),(0,r.kt)("p",null,"\u5e78\u8fd0\u7684\u662f\u6211\u4eec\u6709\u4e00\u4e2a selector \u53ef\u4ee5\u505a\u5230\u8fd9\u70b9\u3002\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5bfc\u5165 selector \u5e76\u5728\u8fd9\u513f\u4f7f\u7528\u5b83\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// redux/selectors.js\n\nexport const getTodosState = (store) => store.todos;\n\nexport const getTodoList = (store) =>\n  getTodosState(store) ? getTodosState(store).allIds : [];\n\nexport const getTodoById = (store, id) =>\n  getTodosState(store) ? { ...getTodosState(store).byIds[id], id } : {};\n\nexport const getTodos = (store) =>\n  getTodoList(store).map((id) => getTodoById(store, id));\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// components/TodoList.js\n\n// ...\u5176\u4ed6\u5bfc\u5165\nimport { connect } from "react-redux";\nimport { getTodos } from "../redux/selectors";\n\nconst TodoList = // ... UI \u7ec4\u4ef6\u5b9e\u73b0\n\nexport default connect(state => ({ todos: getTodos(state) }))(TodoList);\n')),(0,r.kt)("p",null,"\u6211\u4eec\u5efa\u8bae\u5728 selector \u51fd\u6570\u4e2d\u5c01\u88c5\u4efb\u4f55\u590d\u6742\u7684\u6570\u636e\u67e5\u627e\u548c\u8ba1\u7b97\u3002\u6b64\u5916\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/reduxjs/reselect"},"Reselect")," \u7f16\u5199\u53ef\u4ee5\u8df3\u8fc7\u4e0d\u5fc5\u8981\u5de5\u4f5c\u7684\u8bb0\u5fc6\u5316 selectors \u6765\u8fdb\u4e00\u6b65\u4f18\u5316\u6027\u80fd\u3002\uff08\u8bf7\u53c2\u9605 ",(0,r.kt)("a",{parentName:"p",href:"https://redux.js.org/recipes/computing-derived-data#sharing-selectors-across-multiple-components"},"the Redux docs page on Computing Derived Data")," \u548c\u535a\u5ba2\u6587\u7ae0 ",(0,r.kt)("a",{parentName:"p",href:"https://blog.isquaredsoftware.com/2017/12/idiomatic-redux-using-reselect-selectors/"},"Idiomatic Redux: Using Reselect Selectors for Encapsulation and Performance")," \u4e86\u89e3\u6709\u5173\u4e3a\u4ec0\u4e48\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528 selector \u51fd\u6570\u7684\u66f4\u591a\u4fe1\u606f\u3002\uff09"),(0,r.kt)("p",null,"\u73b0\u5728\u6211\u4eec\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"<TodoList />")," \u5df2\u8fde\u63a5\u5230 store\u3002\u5b83\u5e94\u8be5\u63a5\u6536 todos \u7684\u5217\u8868\uff0c\u6620\u5c04\u5b83\u4eec\uff0c\u5e76\u5c06\u6bcf\u4e2a todo \u4f20\u9012\u7ed9 ",(0,r.kt)("inlineCode",{parentName:"p"},"<Todo />")," \u7ec4\u4ef6\u3002",(0,r.kt)("inlineCode",{parentName:"p"},"<Todo />")," \u5c06\u4f9d\u6b21\u628a\u5b83\u4eec\u6e32\u67d3\u5230\u5c4f\u5e55\u4e0a\u3002\u73b0\u5728\u5c1d\u8bd5\u6dfb\u52a0 todo\u3002\u5b83\u5e94\u8be5\u51fa\u73b0\u5728\u6211\u4eec\u7684 todo \u6e05\u5355\u4e0a\uff01"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/N68xvrG.png",alt:null})),(0,r.kt)("p",null,"\u6211\u4eec\u5c06\u8fde\u63a5\u66f4\u591a\u7684\u7ec4\u4ef6\u3002\u5728\u6211\u4eec\u8fd9\u6837\u505a\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u5148\u6682\u505c\u4e00\u4e0b\uff0c\u5e76\u4e86\u89e3\u66f4\u591a\u5173\u4e8e ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u7684\u4fe1\u606f\u3002"),(0,r.kt)("h3",{id:"\u5e38\u89c1\u7684\u8c03\u7528-connect-\u65b9\u5f0f"},"\u5e38\u89c1\u7684\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"h3"},"connect")," \u65b9\u5f0f"),(0,r.kt)("p",null,"\u6839\u636e\u4f60\u4f7f\u7528\u7684\u7ec4\u4ef6\u7c7b\u578b\uff0c\u6709\u4e0d\u540c\u7684\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u65b9\u5f0f\uff0c\u6700\u5e38\u89c1\u7684\u603b\u7ed3\u5982\u4e0b\uff1a"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"\u4e0d\u8ba2\u9605 Store"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8ba2\u9605 Store"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u4e0d\u6ce8\u5165 Action Creators"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"connect()(Component)")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"connect(mapStateToProps)(Component)"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u6ce8\u5165 Action Creators"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"connect(null, mapDispatchToProps)(Component)")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"connect(mapStateToProps, mapDispatchToProps)(Component)"))))),(0,r.kt)("h4",{id:"\u4e0d\u8ba2\u9605-store-\u4e14\u4e0d\u6ce8\u5165-action-creators"},"\u4e0d\u8ba2\u9605 store \u4e14\u4e0d\u6ce8\u5165 action creators"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u5728\u4e0d\u63d0\u4f9b\u4efb\u4f55\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect"),"\uff0c\u4f60\u7684\u7ec4\u4ef6\u5c06\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5f53 store \u6539\u53d8\u65f6 ",(0,r.kt)("em",{parentName:"li"},"\u4e0d\u4f1a")," \u91cd\u6e32\u67d3"),(0,r.kt)("li",{parentName:"ul"},"\u63a5\u6536 ",(0,r.kt)("inlineCode",{parentName:"li"},"props.dispatch")," \u4f60\u53ef\u4ee5\u7528\u5b83\u6765\u624b\u52a8 dispatch action")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// ... Component\nexport default connect()(Component); // \u7ec4\u4ef6\u5c06\u63a5\u6536 `dispatch`\uff08\u5c31\u50cf\u6211\u4eec\u7684 <TodoList />\uff01\uff09\n")),(0,r.kt)("h4",{id:"\u8ba2\u9605-store-\u4e0d\u6ce8\u5165-action-creators"},"\u8ba2\u9605 store \u4e0d\u6ce8\u5165 action creators"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u4ec5\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps")," \u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect"),"\uff0c\u4f60\u7684\u7ec4\u4ef6\u5c06\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8ba2\u9605 ",(0,r.kt)("inlineCode",{parentName:"li"},"mapStateToProps")," \u4ece store \u4e2d\u63d0\u53d6\u7684\u503c\uff0c\u5e76\u4ec5\u5728\u8fd9\u4e9b\u503c\u53d1\u751f\u66f4\u6539\u65f6\u91cd\u65b0\u6e32\u67d3"),(0,r.kt)("li",{parentName:"ul"},"\u63a5\u6536 ",(0,r.kt)("inlineCode",{parentName:"li"},"props.dispatch")," \u4f60\u53ef\u4ee5\u7528\u5b83\u6765\u624b\u52a8 dispatch action")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// ... Component\nconst mapStateToProps = (state) => state.partOfState;\nexport default connect(mapStateToProps)(Component);\n")),(0,r.kt)("h4",{id:"\u4e0d\u8ba2\u9605-store-\u6ce8\u5165-action-creators"},"\u4e0d\u8ba2\u9605 store \u6ce8\u5165 action creators"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u4ec5\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapDispatchToProps")," \u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect"),"\uff0c\u4f60\u7684\u7ec4\u4ef6\u5c06\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5f53 store \u6539\u53d8\u65f6 ",(0,r.kt)("em",{parentName:"li"},"\u4e0d\u4f1a")," \u91cd\u6e32\u67d3"),(0,r.kt)("li",{parentName:"ul"},"\u63a5\u6536\u4f60\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"mapDispatchToProps")," \u4f5c\u4e3a props \u6ce8\u5165\u7684\u6bcf\u4e2a action creators\uff0c\u5e76\u5728\u88ab\u8c03\u7528\u65f6\u81ea\u52a8 dispatch actions")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { addTodo } from './actionCreators';\n// ... Component\nexport default connect(null, { addTodo })(Component);\n")),(0,r.kt)("h4",{id:"\u8ba2\u9605-store-\u6ce8\u5165-action-creators"},"\u8ba2\u9605 store \u6ce8\u5165 action creators"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u540c\u65f6\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"mapDispatchToProps")," ",(0,r.kt)("inlineCode",{parentName:"p"},"connect"),"\uff0c\u4f60\u7684\u7ec4\u4ef6\u5c06\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8ba2\u9605 ",(0,r.kt)("inlineCode",{parentName:"li"},"mapStateToProps")," \u4ece store \u4e2d\u63d0\u53d6\u7684\u503c\uff0c\u5e76\u4ec5\u5728\u8fd9\u4e9b\u503c\u53d1\u751f\u66f4\u6539\u65f6\u91cd\u65b0\u6e32\u67d3"),(0,r.kt)("li",{parentName:"ul"},"\u63a5\u6536\u4f60\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"mapDispatchToProps")," \u6ce8\u5165\u7684\u6240\u6709 action creators \u4f5c\u4e3a props \u5e76\u81ea\u52a8\u5728\u88ab\u8c03\u7528\u65f6 dispatch actions\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import * as actionCreators from './actionCreators';\n// ... Component\nconst mapStateToProps = (state) => state.partOfState;\nexport default connect(mapStateToProps, actionCreators)(Component);\n")),(0,r.kt)("p",null,"\u8fd9\u56db\u79cd\u60c5\u51b5\u6db5\u76d6\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u6700\u57fa\u672c\u7684\u7528\u6cd5\u3002\u8981\u4e86\u89e3\u6709\u5173 ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u7ee7\u7eed\u9605\u8bfb\u6211\u4eec\u7684 ",(0,r.kt)("a",{parentName:"p",href:"/api/connect"},"API \u90e8\u5206")," \u8be5\u90e8\u5206\u5bf9\u5176\u8fdb\u884c\u4e86\u66f4\u8be6\u7ec6\u7684\u89e3\u91ca\u3002"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"\u73b0\u5728\u8ba9\u6211\u4eec\u8fde\u63a5 ",(0,r.kt)("inlineCode",{parentName:"p"},"<TodoApp />")," \u7684\u5176\u4f59\u90e8\u5206\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u5b9e\u73b0 toggling todos \u7684\u4ea4\u4e92\u5462? \u654f\u9510\u7684\u8bfb\u8005\u53ef\u80fd\u5df2\u7ecf\u6709\u4e86\u7b54\u6848\u3002\u5982\u679c\u4f60\u5df2\u7ecf\u8bbe\u7f6e\u597d\u4f60\u7684\u73af\u5883\u5e76\u4e00\u76f4\u8ddf\u8fdb\u5230\u8fd9\u4e00\u70b9\uff0c\u90a3\u4e48\u73b0\u5728\u662f\u653e\u4e0b\u5b83\u5e76\u81ea\u5df1\u5b9e\u73b0\u8be5\u529f\u80fd\u7684\u597d\u65f6\u673a\u3002\u6211\u4eec\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u8fde\u63a5 ",(0,r.kt)("inlineCode",{parentName:"p"},"<Todo />")," \u6765 dispatch ",(0,r.kt)("inlineCode",{parentName:"p"},"toggleTodo")," \u4e5f\u5c31\u4e0d\u8db3\u4e3a\u5947\u4e86\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// components/Todo.js\n\n// ... \u5176\u4ed6\u5bfc\u5165\nimport { connect } from "react-redux";\nimport { toggleTodo } from "../redux/actions";\n\nconst Todo = // ... \u7ec4\u4ef6\u5b9e\u73b0\n\nexport default connect(\n  null,\n  { toggleTodo }\n)(Todo);\n')),(0,r.kt)("p",null,"\u73b0\u5728\u6211\u4eec\u7684 todo \u53ef\u4ee5\u5207\u6362\u5b8c\u6210\u3002\u6211\u4eec\u5feb\u5b8c\u6210\u4e86\uff01"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/4UBXYtj.png",alt:null})),(0,r.kt)("p",null,"\u6700\u540e\uff0c\u8ba9\u6211\u4eec\u53bb\u5b9e\u73b0 ",(0,r.kt)("inlineCode",{parentName:"p"},"VisibilityFilters")," \u7279\u6027\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"<VisibilityFilters />")," \u9700\u8981\u80fd\u591f\u4ece store \u4e2d\u8bfb\u53d6\u5f53\u524d\u6d3b\u52a8\u72b6\u6001\u7684\u8fc7\u6ee4\u5668\uff0c\u5e76 dispatch actions \u5230 store\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u540c\u65f6\u4f20\u9012 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"mapDispatchToProps"),"\u3002\u8fd9\u91cc\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps")," \u53ef\u4ee5\u662f ",(0,r.kt)("inlineCode",{parentName:"p"},"visibilityFilter")," \u72b6\u6001\u7684\u7b80\u5355\u8bbf\u95ee\u5668\u3002\u5e76\u4e14 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapDispatchToProps")," \u5c06\u5305\u542b ",(0,r.kt)("inlineCode",{parentName:"p"},"setFilter")," action creator\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// components/VisibilityFilters.js\n\n// ... \u5176\u4ed6\u5bfc\u5165\nimport { connect } from "react-redux";\nimport { setFilter } from "../redux/actions";\n\nconst VisibilityFilters = // ... \u7ec4\u4ef6\u5b9e\u73b0\n\nconst mapStateToProps = state => {\n  return { activeFilter: state.visibilityFilter };\n};\nexport default connect(\n  mapStateToProps,\n  { setFilter }\n)(VisibilityFilters);\n')),(0,r.kt)("p",null,"\u540c\u65f6\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u66f4\u65b0\u6211\u4eec\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"<TodoList />")," \u7ec4\u4ef6\u4ee5\u6839\u636e\u6d3b\u52a8\u8fc7\u6ee4\u5668\u8fc7\u6ee4 todos\u3002\u4ee5\u524d\u6211\u4eec\u4f20\u9012\u7ed9 ",(0,r.kt)("inlineCode",{parentName:"p"},"<TodoList />")," ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," \u51fd\u6570\u8c03\u7528\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"mapStateToProps")," \u53ea\u662f\u9009\u62e9\u6574\u4e2a todos \u5217\u8868\u7684\u9009\u62e9\u5668\u3002\u8ba9\u6211\u4eec\u7f16\u5199\u53e6\u4e00\u4e2a\u9009\u62e9\u5668\u6765\u5e2e\u52a9\u6309\u72b6\u6001\u8fc7\u6ee4\u7684 todos\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// redux/selectors.js\n\n// ... other selectors\nexport const getTodosByVisibilityFilter = (store, visibilityFilter) => {\n  const allTodos = getTodos(store);\n  switch (visibilityFilter) {\n    case VISIBILITY_FILTERS.COMPLETED:\n      return allTodos.filter((todo) => todo.completed);\n    case VISIBILITY_FILTERS.INCOMPLETE:\n      return allTodos.filter((todo) => !todo.completed);\n    case VISIBILITY_FILTERS.ALL:\n    default:\n      return allTodos;\n  }\n};\n")),(0,r.kt)("p",null,"\u5e76\u5728\u9009\u62e9\u5668\u7684\u5e2e\u52a9\u4e0b\u8fde\u63a5\u5230 store\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// components/TodoList.js\n\n// ...\n\nconst mapStateToProps = (state) => {\n  const { visibilityFilter } = state;\n  const todos = getTodosByVisibilityFilter(state, visibilityFilter);\n  return { todos };\n};\n\nexport default connect(mapStateToProps)(TodoList);\n")),(0,r.kt)("p",null,"\u73b0\u5728\u6211\u4eec\u901a\u8fc7 React Redux \u5b8c\u6210\u4e86\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684 todo \u5e94\u7528\u7684\u4f8b\u5b50\u3002\u6211\u4eec\u7684\u6240\u6709\u7ec4\u4ef6\u90fd\u88ab\u8fde\u63a5\u4e0a\u4e86\uff01\u8fd9\u662f\u4e0d\u662f\u5f88\u68d2\uff1f \ud83c\udf89\ud83c\udf8a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/ONqer2R.png",alt:null})),(0,r.kt)("h2",{id:"\u94fe\u63a5"},"\u94fe\u63a5"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://redux.js.org/basics/usage-with-react"},"\u4f7f\u7528 React \u7684\u65b9\u6cd5")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://blog.isquaredsoftware.com/presentations/workshops/redux-fundamentals/react-redux.html"},"\u4f7f\u7528 React Redux \u7ed1\u5b9a")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://medium.com/@franleplant/react-higher-order-components-in-depth-cf9032ee6c3e"},"\u6df1\u5165\u7814\u7a76\u9ad8\u9636\u7ec4\u4ef6")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://redux.js.org/recipes/computing-derived-data#sharing-selectors-across-multiple-components"},"\u8ba1\u7b97\u884d\u751f\u6570\u636e")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://blog.isquaredsoftware.com/2017/12/idiomatic-redux-using-reselect-selectors/"},"\u60ef\u7528\u7684 Redux: \u4f7f\u7528\u91cd\u9009\u9009\u62e9\u5668\u6765\u5b9e\u73b0\u5c01\u88c5\u548c\u6027\u80fd"))),(0,r.kt)("h2",{id:"\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9"},"\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.reactiflux.com"},"Reactiflux")," Redux channel"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stackoverflow.com/questions/tagged/react-redux"},"StackOverflow")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/reduxjs/react-redux/issues/"},"GitHub Issues"))))}m.isMDXComponent=!0}}]);